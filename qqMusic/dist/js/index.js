var dataList,len,control,timer,root=window.player,nowIndex=0,audio=root.audioManager;function getData(t){$.ajax({type:"GET",url:t,success:function(t){len=(dataList=t).length,bindTouch(),bindEvent(),control=new root.controlIndex(len),$("body").trigger("play:change",0)},error:function(){}})}function bindTouch(){var s=$(".pro-bottom").offset().left,n=$(".pro-bottom").offset().width;$(".slider-point").on("touchstart",function(t){t.preventDefault(),root.pros.stop()}).on("touchmove",function(t){t.preventDefault();var o=(t.changedTouches[0].clientX-s)/n;0<=o&&o<=1&&root.pros.update(o)}).on("touchend",function(t){t.preventDefault();var o=(t.changedTouches[0].clientX-s)/n;if(0<=o&&o<1){var a=o*dataList[control.index].duration;$(".play").click(),audio.playTo(a),$(".play").addClass("playing"),audio.status="play",root.pros.start(o)}else 1<=o&&$(".next").click();rotated($(".img-box").attr("data-deg"))})}function bindEvent(){$("body").on("play:change",function(t,o){audio.getAudio(dataList[o].audio),root.render(dataList[o]),root.pros.renderAllTime(dataList[o].duration),"play"==audio.status&&(rotated(0),audio.play(),root.pros.start()),$(".img-box").attr("data-deg",0),$(".img-box").css({transform:"rotateZ(0deg)",transition:"none"})}),$(".prev").on("click",function(){$(".geList").hasClass("showGeList")&&$(".geList").toggleClass("showGeList");var t=control.prev();$("body").trigger("play:change",t),"play"==audio.status?root.pros.start(0):root.pros.update(0)}),$(".next").on("click",function(){$(".geList").hasClass("showGeList")&&$(".geList").toggleClass("showGeList");var t=control.next();$("body").trigger("play:change",t),"play"==audio.status?root.pros.start(0):root.pros.update(0)}),$(".play").on("click",function(){"pause"==audio.status?(audio.play(),root.pros.start(),rotated($(".img-box").attr("data-deg"))):(audio.pause(),root.pros.stop(),clearInterval(timer));$(".play").toggleClass("playing")}),$(".list").on("click",function(){var s='<li class="list">播放列表</li>';dataList.forEach(function(t,o){var a=o==control.index?"list-playing":"";s+='<li key="'+o+'" class="'+a+'">                            <span class="list-song-name">'+t.song+'</span> - <span class="list-singer-name">'+t.singer+"</span>                        </li>"}),$(".geList").html($("<ul>"+s+"</ul>")),$(".geList").toggleClass("showGeList")}),$(".geList").on("click","li:not(.list):not(.list-playing)",function(){var t=$(this).attr("key");t=+t,control.index=t,$("body").trigger("play:change",t),$(".geList").toggleClass("showGeList"),"pause"==audio.status&&$(".play").click()})}function rotated(t){clearInterval(timer),t=+t,timer=setInterval(function(){t+=2,$(".img-box").attr("data-deg",t),$(".img-box").css({transform:"rotateZ("+t+"deg)",transition:"all 0.2s linear"})},200)}getData("../mock/data.json");