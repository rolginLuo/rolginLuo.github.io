var dataList,len,control,timer,root=window.player,nowIndex=0,audio=root.audioManager,loadAudio=!1;function getData(t){$.ajax({type:"GET",url:t,async:!1,success:function(o){o.forEach(function(t,e){$.ajax({type:"GET",url:"http://songsearch.kugou.com/song_search_v2?keyword={"+t.song+"}&page=1&pagesize=30&userid=-1&clientver=&platform=WebFilter&tag=em&filter=2&iscorrection=1&privilege_filter=0",dataType:"jsonp",async:!1,success:function(t){var a=t.data.lists[0];$.ajax({type:"GET",dataType:"jsonp",url:"https://wwwapi.kugou.com/yy/index.php?r=play/getdata&hash="+a.FileHash+"&album_id="+a.AlbumID+"&dfid=1IHtl33graLv0BG4xl4JdtKT&mid=cc88ee5221eae3fee2ff823b47b31418&platid=4",async:!1,success:function(t){o[e].audio=t.data.play_url,o[e].image=t.data.img}})}})}),dataList=o,bindTouch(),bindEvent(),len=dataList.length,control=new root.controlIndex(len),$("body").trigger("play:change",0)},error:function(){}})}function bindTouch(){var o=$(".pro-bottom").offset().left,s=$(".pro-bottom").offset().width;$(".slider-point").on("touchstart",function(t){t.preventDefault(),root.pros.stop()}).on("touchmove",function(t){t.preventDefault();var a=(t.changedTouches[0].clientX-o)/s;0<=a&&a<=1&&root.pros.update(a)}).on("touchend",function(t){t.preventDefault();var a=(t.changedTouches[0].clientX-o)/s;if(0<=a&&a<1){var e=a*dataList[control.index].duration;audio.playTo(e),$(".play").addClass("playing"),audio.status="play",root.pros.start(a)}else 1<=a&&$(".next").click();4==audio.audio.readyState&&rotated($(".img-box").attr("data-deg"))})}function bindEvent(){$("body").on("play:change",function(t,a){clearInterval(timer),root.pros.stop(),loadAudio=!1,audio.getAudio(dataList[a].audio),root.render(dataList[a]),root.pros.renderAllTime(dataList[a].duration);var e=setInterval(function(){(loadAudio||4==audio.audio.readyState)&&(clearInterval(e),"play"==audio.status&&(rotated(0),audio.play(),root.pros.start()),$(".img-box").attr("data-deg",0),$(".img-box").css({transform:"rotateZ(0deg)",transition:"none"}))},500)}),$(".prev").on("click",function(){$(".geList").hasClass("showGeList")&&$(".geList").toggleClass("showGeList");var t=control.prev();$("body").trigger("play:change",t),"play"==audio.status?root.pros.start(0):root.pros.update(0)}),$(".next").on("click",function(){$(".geList").hasClass("showGeList")&&$(".geList").toggleClass("showGeList");var t=control.next();$("body").trigger("play:change",t),"play"==audio.status?root.pros.start(0):root.pros.update(0)}),$(".play").on("click",function(){"pause"==audio.status?(audio.play(),root.pros.start(),rotated($(".img-box").attr("data-deg"))):(audio.pause(),root.pros.stop(),clearInterval(timer));$(".play").toggleClass("playing")}),$(".list").on("click",function(){var o='<li class="list">播放列表</li>';dataList.forEach(function(t,a){var e=a==control.index?"list-playing":"";o+='<li key="'+a+'" class="'+e+'">                            <span class="list-song-name">'+t.song+'</span> - <span class="list-singer-name">'+t.singer+"</span>                        </li>"}),$(".geList").html($("<ul>"+o+"</ul>")),$(".geList").toggleClass("showGeList")}),$(".geList").on("click","li:not(.list):not(.list-playing)",function(){var t=$(this).attr("key");t=+t,control.index=t,$("body").trigger("play:change",t),$(".geList").toggleClass("showGeList"),"pause"==audio.status&&$(".play").click()})}function rotated(t){clearInterval(timer),t=+t,timer=setInterval(function(){t+=2,$(".img-box").attr("data-deg",t),$(".img-box").css({transform:"rotateZ("+t+"deg)",transition:"all 0.2s linear"})},200)}function fullScreen(){var t=document.documentElement;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():elem.msRequestFullscreen&&elem.msRequestFullscreen()}getData("https://www.easy-mock.com/mock/5cfe0097b941f33b9caa04b3/musicMock/kugou_data");